import React, { useState, useEffect } from 'react';
import { Download, Trash2, FileJson, X, Plus } from 'lucide-react';

export default function EIASAnalyzerApp() {
  const [title, setTitle] = useState(() => {
    const stored = localStorage.getItem('eias_title');
    return stored || 'Analyse EIAS';
  });
  
  const [steps, setSteps] = useState(() => {
    const raw = localStorage.getItem('eias_steps');
    return raw ? JSON.parse(raw) : [];
  });

  const [form, setForm] = useState({
    time: '',
    who: '',
    action: '',
    immediate: '',
    rootCauses: '',
    barriers: ''
  });

  const [hovered, setHovered] = useState(null);

  useEffect(() => {
    localStorage.setItem('eias_steps', JSON.stringify(steps));
  }, [steps]);

  useEffect(() => {
    localStorage.setItem('eias_title', title);
  }, [title]);

  const addStep = () => {
    if (!form.time || !form.action) return;
    const newStep = {
      id: Date.now().toString(),
      time: form.time,
      who: form.who || 'infirmier¬∑√®re/soignant¬∑e',
      action: form.action,
      immediate: form.immediate,
      rootCauses: form.rootCauses ? form.rootCauses.split(';').map(s => s.trim()).filter(Boolean) : [],
      barriers: form.barriers ? form.barriers.split(';').map(s => s.trim()).filter(Boolean) : []
    };
    const merged = [...steps, newStep].sort((a, b) => new Date(a.time) - new Date(b.time));
    setSteps(merged);
    setForm({ time: '', who: '', action: '', immediate: '', rootCauses: '', barriers: '' });
  };

  const removeStep = (id) => {
    setSteps(steps.filter(s => s.id !== id));
  };

  const exportJSON = () => {
    const data = { title, steps, exportedAt: new Date().toISOString() };
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${title.replace(/\s+/g, '_')}_EIAS.json`;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  };

  const exportPDF = () => {
    const printContent = document.getElementById('pdf-content');
    const originalContents = document.body.innerHTML;
    
    // Create a clean print version
    const printWindow = document.createElement('div');
    printWindow.innerHTML = `
      <!DOCTYPE html>
      <html>
      <head>
        <title>${title}</title>
        <style>
          @page { size: A4; margin: 2cm; }
          body { font-family: Arial, sans-serif; font-size: 11pt; line-height: 1.6; color: #000; }
          h1 { font-size: 18pt; margin-bottom: 10px; border-bottom: 2px solid #333; padding-bottom: 10px; }
          h2 { font-size: 14pt; margin-top: 20px; margin-bottom: 10px; color: #333; }
          h3 { font-size: 12pt; margin-top: 15px; margin-bottom: 8px; color: #555; }
          .header { margin-bottom: 20px; }
          .metadata { font-size: 9pt; color: #666; margin-bottom: 20px; }
          .step { page-break-inside: avoid; margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 4px; background: #f9f9f9; }
          .step-header { font-weight: bold; margin-bottom: 8px; color: #2563eb; }
          .step-detail { margin: 5px 0; padding-left: 10px; }
          .label { font-weight: 600; color: #444; }
          .causes { color: #b45309; margin-top: 8px; }
          .barriers { color: #065f46; margin-top: 8px; }
          .summary { margin-top: 30px; page-break-before: always; }
          .summary-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
          .summary-table th, .summary-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          .summary-table th { background-color: #f0f0f0; font-weight: bold; }
          ul { margin: 5px 0; padding-left: 20px; }
          li { margin: 3px 0; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>${title}</h1>
          <div class="metadata">
            Date d'export : ${new Date().toLocaleDateString('fr-FR', { 
              year: 'numeric', 
              month: 'long', 
              day: 'numeric',
              hour: '2-digit',
              minute: '2-digit'
            })}<br>
            Nombre d'√©tapes analys√©es : ${steps.length}
          </div>
        </div>

        <h2>Chronologie d√©taill√©e</h2>
        ${steps.map((s, idx) => `
          <div class="step">
            <div class="step-header">
              √âtape ${idx + 1} ‚Äî ${new Date(s.time).toLocaleString('fr-FR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
              })}
            </div>
            <div class="step-detail">
              <span class="label">Acteur :</span> ${s.who}
            </div>
            <div class="step-detail">
              <span class="label">Action :</span> ${s.action}
            </div>
            ${s.immediate ? `
              <div class="step-detail">
                <span class="label">Cause imm√©diate (point de rupture) :</span> ${s.immediate}
              </div>
            ` : ''}
            ${s.rootCauses.length > 0 ? `
              <div class="step-detail causes">
                <span class="label">Causes profondes :</span>
                <ul>
                  ${s.rootCauses.map(c => `<li>${c}</li>`).join('')}
                </ul>
              </div>
            ` : ''}
            ${s.barriers.length > 0 ? `
              <div class="step-detail barriers">
                <span class="label">Barri√®res :</span>
                <ul>
                  ${s.barriers.map(b => `<li>${b}</li>`).join('')}
                </ul>
              </div>
            ` : ''}
          </div>
        `).join('')}

        <div class="summary">
          <h2>Synth√®se des causes profondes</h2>
          <table class="summary-table">
            <thead>
              <tr>
                <th>Cause profonde</th>
                <th>Nombre d'occurrences</th>
                <th>√âtapes concern√©es</th>
              </tr>
            </thead>
            <tbody>
              ${(() => {
                const causesMap = {};
                steps.forEach((s, idx) => {
                  s.rootCauses.forEach(c => {
                    if (!causesMap[c]) causesMap[c] = [];
                    causesMap[c].push(idx + 1);
                  });
                });
                return Object.entries(causesMap).map(([cause, indices]) => `
                  <tr>
                    <td>${cause}</td>
                    <td>${indices.length}</td>
                    <td>${indices.join(', ')}</td>
                  </tr>
                `).join('');
              })()}
            </tbody>
          </table>

          <h2>Synth√®se des barri√®res</h2>
          <table class="summary-table">
            <thead>
              <tr>
                <th>Barri√®re</th>
                <th>Nombre d'occurrences</th>
                <th>√âtapes concern√©es</th>
              </tr>
            </thead>
            <tbody>
              ${(() => {
                const barriersMap = {};
                steps.forEach((s, idx) => {
                  s.barriers.forEach(b => {
                    if (!barriersMap[b]) barriersMap[b] = [];
                    barriersMap[b].push(idx + 1);
                  });
                });
                return Object.entries(barriersMap).map(([barrier, indices]) => `
                  <tr>
                    <td>${barrier}</td>
                    <td>${indices.length}</td>
                    <td>${indices.join(', ')}</td>
                  </tr>
                `).join('');
              })()}
            </tbody>
          </table>
        </div>
      </body>
      </html>
    `;
    
    const printFrame = document.createElement('iframe');
    printFrame.style.position = 'absolute';
    printFrame.style.width = '0';
    printFrame.style.height = '0';
    printFrame.style.border = 'none';
    document.body.appendChild(printFrame);
    
    const doc = printFrame.contentWindow.document;
    doc.open();
    doc.write(printWindow.innerHTML);
    doc.close();
    
    setTimeout(() => {
      printFrame.contentWindow.print();
      setTimeout(() => document.body.removeChild(printFrame), 1000);
    }, 500);
  };

  const resetData = () => {
    if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser toutes les donn√©es ?')) {
      localStorage.removeItem('eias_steps');
      localStorage.removeItem('eias_title');
      setSteps([]);
      setTitle('Analyse EIAS');
    }
  };

  // Timeline calculations
  const width = 900;
  const height = 300;
  const times = steps.map(s => new Date(s.time).getTime());
  const minT = times.length ? Math.min(...times) : Date.now();
  const maxT = times.length ? Math.max(...times) : minT + 1;
  const padding = 40;

  const xFor = (iso) => {
    const t = new Date(iso).getTime();
    if (maxT === minT) return padding + (width - 2 * padding) / 2;
    const frac = (t - minT) / (maxT - minT);
    return padding + frac * (width - 2 * padding);
  };

  const causesMap = {};
  const barriersMap = {};
  steps.forEach(s => {
    s.rootCauses.forEach(c => {
      if (!c) return;
      causesMap[c] = causesMap[c] || [];
      causesMap[c].push(s.id);
    });
    s.barriers.forEach(b => {
      if (!b) return;
      barriersMap[b] = barriersMap[b] || [];
      barriersMap[b].push(s.id);
    });
  });

  return (
    <div className="min-h-screen p-6 bg-gradient-to-br from-slate-50 to-slate-100">
      <div className="max-w-7xl mx-auto">
        <header className="mb-6 bg-white rounded-lg shadow-sm p-6">
          <div className="flex items-center justify-between mb-4">
            <div className="flex-1">
              <input
                value={title}
                onChange={e => setTitle(e.target.value)}
                className="text-3xl font-bold p-2 border-2 border-transparent hover:border-slate-200 rounded-lg focus:border-blue-400 focus:outline-none transition-colors w-full"
                placeholder="Titre de l'analyse"
              />
              <p className="text-sm text-slate-500 mt-2">
                Analyse des √âv√©nements Ind√©sirables Associ√©s aux Soins ‚Äî Chronologie interactive
              </p>
            </div>
          </div>
          
          <div className="flex gap-3">
            <button
              onClick={exportPDF}
              className="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-sm transition-colors"
            >
              <Download size={18} />
              Exporter PDF
            </button>
            <button
              onClick={exportJSON}
              className="flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg shadow-sm transition-colors"
            >
              <FileJson size={18} />
              Exporter JSON
            </button>
            <button
              onClick={resetData}
              className="flex items-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg transition-colors ml-auto"
            >
              <Trash2 size={18} />
              R√©initialiser
            </button>
          </div>
        </header>

        <main className="grid grid-cols-12 gap-6">
          {/* Left panel: Form & List */}
          <section className="col-span-5 bg-white rounded-lg shadow-sm p-6">
            <h3 className="text-lg font-semibold mb-4 text-slate-800">
              Saisie des donn√©es
            </h3>
            
            <div className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-slate-700 mb-1">
                  Date et heure
                </label>
                <input
                  type="datetime-local"
                  value={form.time}
                  onChange={e => setForm({ ...form, time: e.target.value })}
                  className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-slate-700 mb-1">
                  Acteur (anonymis√©)
                </label>
                <input
                  value={form.who}
                  onChange={e => setForm({ ...form, who: e.target.value })}
                  className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent"
                  placeholder="Ex: Infirmier 1, M√©decin senior"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-slate-700 mb-1">
                  Action (fait / omission)
                </label>
                <textarea
                  value={form.action}
                  onChange={e => setForm({ ...form, action: e.target.value })}
                  className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent h-24 resize-none"
                  placeholder="D√©crire l'action ou l'omission..."
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-slate-700 mb-1">
                  Cause imm√©diate (point de rupture)
                </label>
                <input
                  value={form.immediate}
                  onChange={e => setForm({ ...form, immediate: e.target.value })}
                  className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent"
                  placeholder="Ex: Erreur de dosage, oubli de v√©rification"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-slate-700 mb-1">
                  Causes profondes <span className="text-slate-400">(s√©parer par ;)</span>
                </label>
                <input
                  value={form.rootCauses}
                  onChange={e => setForm({ ...form, rootCauses: e.target.value })}
                  className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent"
                  placeholder="Ex: Manque de formation; Protocole absent; Fatigue"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-slate-700 mb-1">
                  Barri√®res <span className="text-slate-400">(s√©parer par ;)</span>
                </label>
                <input
                  value={form.barriers}
                  onChange={e => setForm({ ...form, barriers: e.target.value })}
                  className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-transparent"
                  placeholder="Ex: Checklist; Double v√©rification; Alarme"
                />
              </div>

              <div className="flex gap-2 pt-2">
                <button
                  onClick={addStep}
                  disabled={!form.time || !form.action}
                  className="flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors"
                >
                  <Plus size={18} />
                  Ajouter l'√©tape
                </button>
                <button
                  onClick={() => setForm({ time: '', who: '', action: '', immediate: '', rootCauses: '', barriers: '' })}
                  className="px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg transition-colors"
                >
                  <X size={18} />
                </button>
              </div>
            </div>

            <hr className="my-6 border-slate-200" />

            <h4 className="text-lg font-semibold mb-3 text-slate-800">
              √âtapes enregistr√©es ({steps.length})
            </h4>
            <div className="space-y-2 max-h-96 overflow-y-auto pr-2">
              {steps.length === 0 ? (
                <p className="text-sm text-slate-500 italic py-4 text-center">
                  Aucune √©tape saisie pour le moment
                </p>
              ) : (
                steps.map((s, idx) => (
                  <div
                    key={s.id}
                    className="p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors"
                  >
                    <div className="flex justify-between items-start gap-3">
                      <div className="flex-1">
                        <div className="flex items-center gap-2 mb-1">
                          <span className="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-100 text-blue-700 text-xs font-semibold">
                            {idx + 1}
                          </span>
                          <div className="text-sm font-semibold text-slate-900">
                            {new Date(s.time).toLocaleString('fr-FR')}
                          </div>
                        </div>
                        <div className="text-sm text-slate-700 ml-8">
                          <span className="font-medium">{s.who}</span> ‚Äî {s.action}
                        </div>
                        {s.immediate && (
                          <div className="text-xs text-amber-700 mt-2 ml-8 bg-amber-50 p-2 rounded">
                            <span className="font-semibold">Rupture:</span> {s.immediate}
                          </div>
                        )}
                        {s.rootCauses.length > 0 && (
                          <div className="text-xs text-slate-600 mt-1 ml-8">
                            <span className="font-semibold">Causes:</span> {s.rootCauses.join(', ')}
                          </div>
                        )}
                        {s.barriers.length > 0 && (
                          <div className="text-xs text-slate-600 mt-1 ml-8">
                            <span className="font-semibold">Barri√®res:</span> {s.barriers.join(', ')}
                          </div>
                        )}
                      </div>
                      <button
                        onClick={() => removeStep(s.id)}
                        className="text-red-600 hover:text-red-700 hover:bg-red-50 p-1 rounded transition-colors"
                        title="Supprimer cette √©tape"
                      >
                        <X size={16} />
                      </button>
                    </div>
                  </div>
                ))
              )}
            </div>
          </section>

          {/* Right panel: Timeline */}
          <section className="col-span-7 bg-white rounded-lg shadow-sm p-6">
            <h3 className="text-lg font-semibold mb-4 text-slate-800">
              Frise chronologique interactive
            </h3>
            
            {steps.length === 0 ? (
              <div className="border-2 border-dashed border-slate-300 rounded-lg p-12 text-center">
                <p className="text-slate-500 text-lg mb-2">Aucune donn√©e √† visualiser</p>
                <p className="text-slate-400 text-sm">
                  Ajoutez des √©tapes via le formulaire pour voir la chronologie
                </p>
              </div>
            ) : (
              <>
                <div className="border border-slate-200 rounded-lg p-4 bg-slate-50">
                  <svg width={width} height={height} className="block mx-auto">
                    {/* Timeline baseline */}
                    <line
                      x1={padding}
                      x2={width - padding}
                      y1={height / 2}
                      y2={height / 2}
                      stroke="#94a3b8"
                      strokeWidth={3}
                    />

                    {/* Event circles */}
                    {steps.map((s, idx) => {
                      const x = xFor(s.time);
                      const y = height / 2;
                      const isHovered = hovered && hovered.type === 'step' && hovered.id === s.id;

                      return (
                        <g key={s.id}>
                          <circle
                            cx={x}
                            cy={y}
                            r={18}
                            fill={isHovered ? '#f97316' : '#3b82f6'}
                            stroke={isHovered ? '#ea580c' : '#2563eb'}
                            strokeWidth={2}
                            onMouseEnter={() => setHovered({ type: 'step', id: s.id })}
                            onMouseLeave={() => setHovered(null)}
                            className="cursor-pointer transition-all"
                          />
                          <text
                            x={x}
                            y={y}
                            textAnchor="middle"
                            dominantBaseline="middle"
                            fontSize={12}
                            fontWeight="bold"
                            fill="white"
                          >
                            {idx + 1}
                          </text>
                          <text
                            x={x}
                            y={y + 40}
                            textAnchor="middle"
                            fontSize={11}
                            fill="#475569"
                          >
                            {new Date(s.time).toLocaleTimeString('fr-FR', {
                              hour: '2-digit',
                              minute: '2-digit'
                            })}
                          </text>

                          {isHovered && (
                            <g>
                              <rect
                                x={x < width / 2 ? x + 25 : x - 285}
                                y={y - 90}
                                width={260}
                                height={160}
                                rx={8}
                                fill="white"
                                stroke="#e2e8f0"
                                strokeWidth={2}
                                filter="drop-shadow(0 4px 6px rgba(0,0,0,0.1))"
                              />
                              <foreignObject
                                x={x < width / 2 ? x + 30 : x - 280}
                                y={y - 85}
                                width={250}
                                height={150}
                              >
                                <div className="text-xs p-2">
                                  <div className="font-bold text-sm text-blue-700 mb-1">
                                    {s.who}
                                  </div>
                                  <div className="text-slate-700 mb-2">{s.action}</div>
                                  {s.immediate && (
                                    <div className="text-amber-700 mb-1">
                                      <span className="font-semibold">Rupture:</span> {s.immediate}
                                    </div>
                                  )}
                                  {s.rootCauses.length > 0 && (
                                    <div className="text-slate-600 text-xs mb-1">
                                      <span className="font-semibold">Causes:</span> {s.rootCauses.join(', ')}
                                    </div>
                                  )}
                                  {s.barriers.length > 0 && (
                                    <div className="text-slate-600 text-xs">
                                      <span className="font-semibold">Barri√®res:</span> {s.barriers.join(', ')}
                                    </div>
                                  )}
                                </div>
                              </foreignObject>
                            </g>
                          )}
                        </g>
                      );
                    })}

                    {/* Cause/Barrier connections */}
                    {hovered && hovered.type === 'cause' && (() => {
                      const ids = causesMap[hovered.id] || [];
                      return ids.map(id => {
                        const s = steps.find(x => x.id === id);
                        if (!s) return null;
                        const x = xFor(s.time);
                        const y = height / 2;
                        return (
                          <line
                            key={id}
                            x1={x}
                            y1={y - 20}
                            x2={width - 140}
                            y2={50}
                            stroke="#f59e0b"
                            strokeWidth={2}
                            strokeDasharray="4 3"
                          />
                        );
                      });
                    })()}

                    {hovered && hovered.type === 'barrier' && (() => {
                      const ids = barriersMap[hovered.id] || [];
                      return ids.map(id => {
                        const s = steps.find(x => x.id === id);
                        if (!s) return null;
                        const x = xFor(s.time);
                        const y = height / 2;
                        return (
                          <line
                            key={id}
                            x1={x}
                            y1={y + 20}
                            x2={width - 140}
                            y2={height - 50}
                            stroke="#06b6d4"
                            strokeWidth={2}
                            strokeDasharray="3 3"
                          />
                        );
                      });
                    })()}

                    {/* Side panels */}
                    <foreignObject x={width - 280} y={10} width={270} height={height - 20}>
                      <div className="text-xs space-y-3 p-2">
                        <div>
                          <div className="font-semibold text-sm text-amber-700 mb-2">
                            Causes profondes
                          </div>
                          <div className="space-y-1 max-h-28 overflow-auto">
                            {Object.keys(causesMap).length === 0 ? (
                              <div className="text-slate-400 italic">Aucune cause</div>
                            ) : (
                              Object.keys(causesMap).map(c => (
                                <div
                                  key={c}
                                  onMouseEnter={() => setHovered({ type: 'cause', id: c })}
                                  onMouseLeave={() => setHovered(null)}
                                  className={`p-2 rounded cursor-pointer transition-colors ${
                                    hovered && hovered.type === 'cause' && hovered.id === c
                                      ? 'bg-amber-100 border border-amber-300'
                                      : 'hover:bg-amber-50'
                                  }`}
                                >
                                  <div className="font-medium text-slate-700">{c}</div>
                                  <div className="text-slate-500">{causesMap[c].length} √©tape(s)</div>
                                </div>
                              ))
                            )}
                          </div>
                        </div>

                        <div>
                          <div className="font-semibold text-sm text-cyan-700 mb-2">
                            Barri√®res
                          </div>
                          <div className="space-y-1 max-h-28 overflow-auto">
                            {Object.keys(barriersMap).length === 0 ? (
                              <div className="text-slate-400 italic">Aucune barri√®re</div>
                            ) : (
                              Object.keys(barriersMap).map(b => (
                                <div
                                  key={b}
                                  onMouseEnter={() => setHovered({ type: 'barrier', id: b })}
                                  onMouseLeave={() => setHovered(null)}
                                  className={`p-2 rounded cursor-pointer transition-colors ${
                                    hovered && hovered.type === 'barrier' && hovered.id === b
                                      ? 'bg-cyan-100 border border-cyan-300'
                                      : 'hover:bg-cyan-50'
                                  }`}
                                >
                                  <div className="font-medium text-slate-700">{b}</div>
                                  <div className="text-slate-500">{barriersMap[b].length} √©tape(s)</div>
                                </div>
                              ))
                            )}
                          </div>
                        </div>
                      </div>
                    </foreignObject>
                  </svg>
                </div>

                <div className="mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
                  <p className="text-sm text-blue-900">
                    <span className="font-semibold">üí° Astuce :</span> Survolez les cercles num√©rot√©s pour voir les d√©tails de chaque √©tape. 
                    Survolez une cause ou une barri√®re dans le panneau lat√©ral pour visualiser les connexions avec les √©tapes concern√©es.
                  </p>
                </div>
              </>
            )}
          </section>
        </main>

        <footer className="mt-8 p-4 bg-white rounded-lg shadow-sm text-center">
          <p className="text-sm text-slate-600">
            Application EIAS Analyzer ‚Äî Analyse des √âv√©nements Ind√©sirables Associ√©s aux Soins
          </p>
          <p className="text-xs text-slate-400 mt-1">
            Pr√™te pour h√©bergement GitHub ‚Ä¢ Export PDF et JSON ‚Ä¢ Stockage local navigateur
          </p>
        </footer>
      </div>

      {/* Hidden content for PDF export */}
      <div id="pdf-content" style={{ display: 'none' }}>
        {/* This div is used by the PDF export function */}
      </div>
    </div>
  );
}